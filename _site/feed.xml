<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title></title>
    <description>Leaving the Pipette for a Keyboard.</description>
    <link>http://0.0.0.0:4000/</link>
    <atom:link href="http://0.0.0.0:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Thu, 24 Sep 2015 21:56:09 +0200</pubDate>
    <lastBuildDate>Thu, 24 Sep 2015 21:56:09 +0200</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>Finding the closest element to a number in a vector</title>
        <description>&lt;p&gt;A colleague came to my office the other day with an interesting question:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Is there a way in R to find the closest number to X in a list?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I knowing full well the power the power of R, I naturally said that surely there is such a function, but I have never used it. So I set out to find it because I am curious. It turns out there is not an of the shelf &lt;code&gt;closest&lt;/code&gt; function. There are however a few solution out there which I have collected and are bellow. To top it off there is a comparison of how fast each solution is.&lt;/p&gt;

&lt;h1&gt;solution 1&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://stat.ethz.ch/pipermail/r-help/2008-July/167226.html&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
your.number&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;90000.43&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 90000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;solution 2&lt;/h1&gt;

&lt;p&gt;Same source as before.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;which.min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 90000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;solution 3&lt;/h1&gt;

&lt;p&gt;From &lt;a href=&quot;http://stackoverflow.com/questions/20133344/find-closest-value-in-a-vector-with-binary-search&quot;&gt;here&lt;/a&gt;. It requires &lt;code&gt;data.table&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;data.table&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Installing package into &amp;#39;/home/adomingu/R/x86_64-pc-linux-gnu-library/3.2&amp;#39;
## (as &amp;#39;lib&amp;#39; is unspecified)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in contrib.url(repos, type): trying to use CRAN without setting a mirror
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data.table&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
dt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; data.table&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# you&amp;#39;ll see why val is needed in a sec&lt;/span&gt;
setattr&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;sorted&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;x&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# let data.table know that w is sorted&lt;/span&gt;
setkey&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# sorts the data&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# binary search and &amp;quot;roll&amp;quot; to the nearest neighbour&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# In the final expression the val column will have the you&amp;#39;re looking for.&lt;/span&gt;
dt&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;J&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; roll &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;nearest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##        x   val
## 1: 90000 90000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Speed comparison&lt;/h1&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;## time:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# solution1&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;system.time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    user  system elapsed 
##   0.024   0.020   0.043
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# solution2&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;system.time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;which.min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    user  system elapsed 
##   0.008   0.004   0.012
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# solution3&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;system.time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dt&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;J&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;your.number&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; roll &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;nearest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    user  system elapsed 
##   0.000   0.000   0.001
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To my surprise the base R functions perform pretty well, though in really large datasets &lt;code&gt;data.table&lt;/code&gt; is worth a punt.&lt;/p&gt;
</description>
        <pubDate>Thu, 24 Sep 2015 00:00:00 +0200</pubDate>
        <link>http://0.0.0.0:4000/2015/09/24/2015-09-24-finding-closest-element-to-a-number-in-a-list/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/09/24/2015-09-24-finding-closest-element-to-a-number-in-a-list/</guid>
        
        <category>R</category>
        
        
      </item>
    
      <item>
        <title>Table of results embed in a PDF</title>
        <description>&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;: This is a rant.&lt;/p&gt;

&lt;p&gt;I had to run a quick analysis on someone else&amp;#39;s results. You probably know the drill: there is a paper which reported a list of differential expressed genes for a condition that is relevant to your project. One thinks:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Great! Assuming the analysis is correct, I can poke around their data and compare/extract results that are relevant to my project.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;That is where the fun ends. In this particular paper, they where kind enough to report the processed tables of results in a single PDF.&lt;/p&gt;

&lt;p&gt;Seriously? All 4 tables of results were embedded in a single PDF. The lists of up and down-regulated genes spanned several pages. Is it that hard to have supplement text files with the relevant tables? Or if that is not convenient for data presentation (yes, there were highlighted row in the tables), at the very least make the original excel tables available. Unless all the calculations were painstakingly done by hand and noted down in Word, it seems that it was more difficult to move the table from Excel -&amp;gt; Word -&amp;gt; PDF than just published the excel files in the first place.&lt;/p&gt;

&lt;h2&gt;Extraction of table from PDF to R-friendly format&lt;/h2&gt;

&lt;p&gt;To extract the list of differentially expressed genes embedded in the supp. data pdf, I used okular following this &lt;a href=&quot;http://stackoverflow.com/a/11437638/1274242&quot;&gt;tip&lt;/a&gt;. However, when copying directly to Oo Calc I stumbled upon some encoding problems, so in the end table was copied to a text editor (the column that was relevant to me). It is not ideal but solved the problem. It took me an hour all in all.&lt;/p&gt;

&lt;p&gt;Of course, I could have download the raw reads, QC, map, count, re-do the analysis, compare to the published results to make sure all is kosher, but having the table of DEG saves a lot time that we can focus on extracting biologically relevant insights. That is what science should be about and sharing knowledge, in the format of papers, should be a help in this endeavor and not an hindrance.&lt;/p&gt;
</description>
        <pubDate>Thu, 16 Apr 2015 15:52:02 +0200</pubDate>
        <link>http://0.0.0.0:4000/2015/04/16/rant-about-results-tables/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/04/16/rant-about-results-tables/</guid>
        
        <category>Jekyll</category>
        
        
      </item>
    
      <item>
        <title>Painless installation of R packages from source</title>
        <description>&lt;p&gt;I was minding my own business trying to add labels to a line plot in &lt;code&gt;ggplot2&lt;/code&gt;. Then I saw that the package &lt;a href=&quot;http://directlabels.r-forge.r-project.org/&quot;&gt;directlabels&lt;/a&gt; would solve all my problems with one single line of code. I proceed to install it using &lt;code&gt;install.packages(&amp;quot;directlabels&amp;quot;, repo=&amp;quot;http://r-forge.r-project.org&amp;quot;)&lt;/code&gt;. Sadly:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;package &lt;code&gt;directlabels&lt;/code&gt; is not available (for R version 3.1.3)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Usually, I would download the source code, then use &lt;code&gt;install.packages()&lt;/code&gt; from source. But this still did not work due some dependency issues. Thankfully there is the package &lt;code&gt;devtools&lt;/code&gt; to help:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;devtools&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
install_url&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://cran.r-project.org/src/contrib/directlabels_2013.6.15.tar.gz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;directlabels&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As simple as that. It also allows installation from github repos. &lt;/p&gt;
</description>
        <pubDate>Thu, 16 Apr 2015 11:32:22 +0200</pubDate>
        <link>http://0.0.0.0:4000/2015/04/16/install-r-packages-from-source/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/04/16/install-r-packages-from-source/</guid>
        
        <category>R</category>
        
        <category>devtools</category>
        
        
      </item>
    
      <item>
        <title>Testing for chromosome over-representation</title>
        <description>&lt;p&gt;Sometimes I am working on some data and notice certain biases, say differentially expressed genes appearing to originate more often from a chromosome. Or a factor binding more often to a class of transcripts. In these situations I tend to turn to Fisher&amp;#39;s exact test. Here I will put an example of what I do.&lt;/p&gt;

&lt;h2&gt;Get some data&lt;/h2&gt;

&lt;p&gt;For the sake of simplicity I will use data from the Pasilla&lt;a href=&quot;http://bioconductor.org/packages/release/data/experiment/html/pasilla.html&quot;&gt;1&lt;/a&gt; dataset and run differential gene expression analysis with DESeq2&lt;a href=&quot;http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html&quot;&gt;2&lt;/a&gt; following the vignette&amp;#39;s instructions. The &lt;code&gt;data.table&lt;/code&gt; package is used because I like it&amp;#39;s speed and syntax, specially for sub-setting. Since I am still learning all the ins and outs of it, I mix &lt;code&gt;data.frame&lt;/code&gt; code with it. Whatever works.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;data.table&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;pasilla&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Biobase&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;pasillaGenes&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;DESeq2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;biomaRt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;While loading the &lt;code&gt;pasillaGenes&lt;/code&gt; R was throwing an error at me:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Warning: namespace ‘DESeq’ is not available and has been replaced&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It turns out that &lt;code&gt;DESeq&lt;/code&gt; needed to be installed to load the data. No idea why. So let&amp;#39;s get us some results:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;countData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; counts&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pasillaGenes&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
colData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; pData&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pasillaGenes&lt;span class=&quot;p&quot;&gt;)[,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;condition&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
dds &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; DESeqDataSetFromMatrix&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   countData &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; countData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   colData &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; colData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   design &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; condition
   &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
dds&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;condition &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; relevel&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dds&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;condition&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;untreated&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
dds &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; DESeq&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dds&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Add chromosome information&lt;/h2&gt;

&lt;p&gt;Now the fun starts. I created a &lt;code&gt;data.table&lt;/code&gt; with the results plus gene IDs, And will now added some extra information with biomaRt. I have only added chromosome and biotype, but the amount of information one can add is large. I usually also add gene symbol and description. Very useful to have a quick idea of the function of a particular gene. Adding the full gene location might be useful to later on subset data and easily create a bed file.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;res &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;results&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dds&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;results&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dds&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
res &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; data.table&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ensembl &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; useMart&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ensembl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; dataset &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;dmelanogaster_gene_ensembl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
genemap &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; getBM&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; attributes &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ensembl_gene_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;chromosome_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gene_biotype&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                  filters &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ensembl_gene_id&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                  values &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                  mart &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ensembl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
idx &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; genemap&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;chromosome &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; genemap&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;chromosome_name&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; idx &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;gene_biotype &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; genemap&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;gene_biotype&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; idx &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now let&amp;#39;s have a look at down-regulated genes with &lt;code&gt;padj &amp;lt; 0.1&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;padj &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; log2FoldChange &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##        baseMean log2FoldChange     lfcSE      stat       pvalue
##   1:   85.00693     -0.7067901 0.2196386 -3.217969 1.291017e-03
##   2:  273.13010     -0.3878740 0.1360678 -2.850593 4.363776e-03
##   3: 1257.88508     -0.3896927 0.1321601 -2.948640 3.191754e-03
##   4:  280.32056     -0.4471012 0.1417352 -3.154483 1.607826e-03
##   5:  141.36961     -1.3409377 0.2076951 -6.456280 1.073079e-10
##  ---                                                           
## 404:  998.56567     -0.4335869 0.1357833 -3.193228 1.406921e-03
## 405:   16.42232     -0.6973109 0.2276632 -3.062906 2.191992e-03
## 406:  373.24468     -0.4988888 0.1441100 -3.461860 5.364557e-04
## 407: 2891.60114     -1.6134844 0.1706094 -9.457183 3.163516e-21
## 408:  973.77088     -0.8325356 0.1332384 -6.248464 4.145082e-10
##              padj ensembl_gene_id chromosome   gene_biotype
##   1: 2.007727e-02     FBgn0000079         2R protein_coding
##   2: 5.230444e-02     FBgn0000244         3R protein_coding
##   3: 4.105429e-02     FBgn0000256         2L protein_coding
##   4: 2.389391e-02     FBgn0000286         2L protein_coding
##   5: 1.045641e-08     FBgn0000406         2L protein_coding
##  ---                                                       
## 404: 2.158653e-02     FBgn0261545         2R protein_coding
## 405: 3.079189e-02     FBgn0261546         NA             NA
## 406: 9.950931e-03     FBgn0261547         3L protein_coding
## 407: 1.106943e-18     FBgn0261552         3R protein_coding
## 408: 3.710330e-08     FBgn0261560         2L protein_coding&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Most of these appear to be coding genes. Not a great surprise. But...  Oh! There are a lot of genes located in chromosome 2L. Is this a coincidence? Let us test it.&lt;/p&gt;

&lt;h2&gt;Test for over-representation&lt;/h2&gt;

&lt;h3&gt;Chromosome 3L&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;chrom&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;3L&amp;quot;&lt;/span&gt;
all &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; res&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id
hits &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;padj &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; log2FoldChange &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id
hits_in_chr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;chromosome &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; chrom &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; padj &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; log2FoldChange &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
genes_in_chr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;chromosome &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; chrom&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
hits_total &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hits&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
genes_total &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Expected number of hits in chromosome 3L would be 71.8440912 and we have 61. Is this significant? I will use Fisher&amp;#39;s exact test, as applied &lt;a href=&quot;https://www.biostars.org/p/102946/&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;http://cgrlucb.wikispaces.com/Functional+Enrichment+Analysis&quot;&gt;here&lt;/a&gt; for very similar problems.&lt;/p&gt;

&lt;p&gt;Firstly I construct a table/matrix with the events and from that calculated Fisher&amp;#39;s Exact test, or the probability of having more genes in chromosome 3L than expected by chance. There are more details &lt;a href=&quot;http://cgrlucb.wikispaces.com/Functional+Enrichment+Analysis&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      genes_in_chr&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      hits_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      genes_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;genes_in_chr&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;hits_in_chr
      &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
      nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mat&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##      [,1]  [,2]
## [1,]   61   347
## [2,] 2487 11575&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fisher.test&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alternative&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;greater&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
fr&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
##  Fisher&amp;#39;s Exact Test for Count Data
## 
## data:  mat
## p-value = 0.935
## alternative hypothesis: true odds ratio is greater than 1
## 95 percent confidence interval:
##  0.6400274       Inf
## sample estimates:
## odds ratio 
##  0.8181856&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;So there is a p-value of 0.9349979 and we can reject the hypothesis that there is enrichment for or genes in 3L. My eyes were seeing patterns where this is none. Also, since I was testing only for over-representation, or enrichment, the option &lt;code&gt;alternative=&amp;quot;greater&amp;quot;&lt;/code&gt; was used in the test. Other options are available.&lt;/p&gt;

&lt;h3&gt;For all chromosomes&lt;/h3&gt;

&lt;p&gt;Is this this the case for any of the other chromosome? I will construct a function, and then loop over the chromosomes.&lt;/p&gt;

&lt;p&gt;The function &lt;code&gt;chrEnrichment&lt;/code&gt; is minimal and it only tests for down-regulated gens, but could be easily extended to add other arguments. It could also be used to test for biases in gene biotype.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;chrEnrichment &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;# Test for chromosome overpresentation in DESe2 results&lt;/span&gt;
   all &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id
   hits &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;padj &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; log2FoldChange &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id

   hits_in_chr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;chromosome &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; chr &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; padj &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; log2FoldChange &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   genes_in_chr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;chromosome &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; chr&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ensembl_gene_id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   hits_total &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hits&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   genes_total &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   mat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
         hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         genes_in_chr&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         hits_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         genes_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;hits_total&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;genes_in_chr&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;hits_in_chr
         &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         nrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         ncol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   fr &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fisher.test&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alternative&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;greater&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      chromosome &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; chromosome&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      observed &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; hits_in_chr&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      expected &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hits_total &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; genes_in_chr &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; genes_total&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
      odds.ratio&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; fr&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;estimate&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;odds ratio&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;
      pvalue &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; fr&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;p.value
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


chromosomes &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;na.omit&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;like&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;chromosome&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Zv9&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;chromosome&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
l_res &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;chromosome &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; chromosomes&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
   l_res&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;chromosome&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; chrEnrichment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;chromosome&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; res&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

table_fisher &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rbindlist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;l_res&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
table_fisher&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;FDR&lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt;p.adjust&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pvalue&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;bonferroni&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# add FDR&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    chromosome observed expected odds.ratio     pvalue       FDR
## 1:         2R       91     78.1  1.2197190 0.05874683 0.4112278
## 2:         3L       61     71.8  0.8181856 0.93499788 1.0000000
## 3:         2L       86     70.2  1.2958104 0.02276513 0.1593559
## 4:         3R       95     90.2  1.0719388 0.29753414 1.0000000
## 5:          X       46     58.6  0.7523146 0.97261113 1.0000000
## 6:          4        0      2.3  0.0000000 1.00000000 1.0000000
## 7:       YHet        0      0.4  0.0000000 1.00000000 1.0000000&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;setkey&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;table_fisher&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; FDR&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# will also sort by pvalue&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Since I am testing for all chromosomes, I have also calculated the adjusted p-value (bonferroni) to be on the safe side.&lt;/p&gt;

&lt;p&gt;And what does Fisher say?&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;table_fisher&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    chromosome observed expected odds.ratio     pvalue       FDR
## 1:         2L       86     70.2  1.2958104 0.02276513 0.1593559
## 2:         2R       91     78.1  1.2197190 0.05874683 0.4112278
## 3:         3L       61     71.8  0.8181856 0.93499788 1.0000000
## 4:         3R       95     90.2  1.0719388 0.29753414 1.0000000
## 5:          X       46     58.6  0.7523146 0.97261113 1.0000000
## 6:          4        0      2.3  0.0000000 1.00000000 1.0000000
## 7:       YHet        0      0.4  0.0000000 1.00000000 1.0000000&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;That we have a pretty much random distribution of down-regulated genes in the fly chromosomes.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;sessionInfo&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## R version 3.1.3 (2015-03-09)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.2 LTS
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=de_DE.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=de_DE.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats4    parallel  methods   stats     graphics  grDevices utils    
## [8] datasets  base     
## 
## other attached packages:
##  [1] biomaRt_2.22.0            DESeq2_1.6.3             
##  [3] RcppArmadillo_0.4.650.1.1 Rcpp_0.11.5              
##  [5] GenomicRanges_1.18.4      GenomeInfoDb_1.2.4       
##  [7] IRanges_2.0.1             S4Vectors_0.4.0          
##  [9] Biobase_2.26.0            BiocGenerics_0.12.1      
## [11] pasilla_0.5.1             data.table_1.9.4         
## [13] knitr_1.9                
## 
## loaded via a namespace (and not attached):
##  [1] acepack_1.3-3.3      annotate_1.44.0      AnnotationDbi_1.28.1
##  [4] base64enc_0.1-2      BatchJobs_1.5        BBmisc_1.9          
##  [7] BiocParallel_1.0.3   bitops_1.0-6         brew_1.0-6          
## [10] checkmate_1.5.1      chron_2.3-45         cluster_2.0.1       
## [13] codetools_0.2-11     colorspace_1.2-6     DBI_0.3.1           
## [16] DESeq_1.18.0         digest_0.6.8         evaluate_0.5.5      
## [19] fail_1.2             foreach_1.4.2        foreign_0.8-63      
## [22] formatR_1.0          Formula_1.2-0        genefilter_1.48.1   
## [25] geneplotter_1.44.0   ggplot2_1.0.1        grid_3.1.3          
## [28] gtable_0.1.2         Hmisc_3.15-0         iterators_1.0.7     
## [31] lattice_0.20-30      latticeExtra_0.6-26  locfit_1.5-9.1      
## [34] MASS_7.3-39          munsell_0.4.2        nnet_7.3-9          
## [37] plyr_1.8.1           proto_0.3-10         RColorBrewer_1.1-2  
## [40] RCurl_1.95-4.5       reshape2_1.4.1       rpart_4.1-9         
## [43] RSQLite_1.0.0        scales_0.2.4         sendmailR_1.2-1     
## [46] splines_3.1.3        stringr_0.6.2        survival_2.38-1     
## [49] tools_3.1.3          XML_3.98-1.1         xtable_1.7-4        
## [52] XVector_0.6.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        <pubDate>Thu, 19 Mar 2015 10:32:22 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/03/19/chromosome-over-representation-in-DGE/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/03/19/chromosome-over-representation-in-DGE/</guid>
        
        <category>R</category>
        
        <category>Bioconductor</category>
        
        <category>Fisher</category>
        
        <category>biomaRt</category>
        
        
      </item>
    
      <item>
        <title>Reminder - building blog locally with Jekyll</title>
        <description>&lt;p&gt;It took me while from moving my blog from &lt;a href=&quot;https://movingtothedarkside.wordpress.com/&quot;&gt;wordpress&lt;/a&gt; to &lt;a href=&quot;http://adomingues.github.io/&quot;&gt;github pages&lt;/a&gt; and writing a new post. Such a long time that I forgot that to build the site locally I need to use &lt;code&gt;bundle exec jekyll serve --watch&lt;/code&gt; instead of &lt;code&gt;jekyll serve --watch&lt;/code&gt;. &lt;/p&gt;

&lt;p&gt;I won&amp;#39;t forget now. &lt;/p&gt;
</description>
        <pubDate>Wed, 18 Mar 2015 09:47:02 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/03/18/local-jeckyll-build/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/03/18/local-jeckyll-build/</guid>
        
        <category>Jekyll</category>
        
        
      </item>
    
      <item>
        <title>Install bioconductor packages from SVN</title>
        <description>&lt;p&gt;Due to some issues with the way DEXseq calculates the &lt;a href=&quot;https://support.bioconductor.org/p/64997/&quot;&gt;log2foldchanges&lt;/a&gt; I decided to re-run an analysis with the issue fixed. Since it is not yet in the development branch, an install from svn was needed  - my first!&lt;/p&gt;

&lt;p&gt;Firstly the source code was downloaded with:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;svn co --username &lt;span class=&quot;nb&quot;&gt;readonly&lt;/span&gt; --password &lt;span class=&quot;nb&quot;&gt;readonly &lt;/span&gt;https://hedgehog.fhcrc.org/bioconductor/branches/RELEASE_3_0/madman/Rpacks/DEXSeq DEXSeq&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This followed a build to generated a package:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;R CMD build --no-build-vignettes DEXSeq&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I had issues with the build process, which failed during the vignette build. As I don&amp;#39;t care about it, using &lt;code&gt;--no-build-vignettes&lt;/code&gt; bypassed the problem. Then it was a simply matter of starting R and installing the package:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;DEXSeq_1.12.2.tar.gz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; repos&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Simple.&lt;/p&gt;
</description>
        <pubDate>Wed, 25 Feb 2015 13:50:24 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/02/25/install-bioconductor-packages-from-svn/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/02/25/install-bioconductor-packages-from-svn/</guid>
        
        
      </item>
    
      <item>
        <title>virtualenvs or: How I Learned to Stop Worrying and Love not having sudo powers in a server</title>
        <description>&lt;p&gt;Well, you might think, there is always &lt;code&gt;pip install --user&lt;/code&gt;. Aha! Yes, that works most of the time, but not when some package upgrade (distribute for deepTools) conflicts with globally installed packages.&lt;/p&gt;

&lt;h2&gt;The solution (for python packages)&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Python virtualenvs&lt;/em&gt; to the rescue!&lt;/p&gt;

&lt;p&gt;These have been around for sometime, but I never felt inclined to dig into it until now (I can also be a bit of a &lt;em&gt;Luddite&lt;/em&gt;). Put simply, &lt;em&gt;virtualenvs&lt;/em&gt; are reservoirs of custom python and package installations. In practice, one creates a folder where all the packages can be installed, and then simply source it. From that point on, everythying done in python is using whathever is in that folder or &lt;em&gt;virtualenv&lt;/em&gt;. Even a copy of the python binary will be there.&lt;/p&gt;

&lt;p&gt;One of the major appeals, for me at least, is that no &lt;em&gt;sudo&lt;/em&gt; is required for the set-up of the &lt;em&gt;virtualenv&lt;/em&gt; or installation of packages. Also, one can have multiple virtualenvs, say for different projects.&lt;/p&gt;

&lt;p&gt;For a proper (practical tutorial) see this post by &lt;a href=&quot;http://www.dabapps.com/blog/introduction-to-pip-and-virtualenv-python/&quot;&gt;Jamie Mathews&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In the meantime, &lt;em&gt;deepTools&lt;/em&gt; just finished compiling and I can now go to work.&lt;/p&gt;
</description>
        <pubDate>Wed, 28 Jan 2015 07:45:06 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/01/28/virtualenvs-or-how-i-learned-to-stop-worrying-and-love-not-having-sudo-powers-in-a-server/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/01/28/virtualenvs-or-how-i-learned-to-stop-worrying-and-love-not-having-sudo-powers-in-a-server/</guid>
        
        
      </item>
    
      <item>
        <title>Clone all repositories from a user (bitbucket)</title>
        <description>&lt;p&gt;Now that I have computer, the next step is to install everything I use on daily basis, and set-up my projects space. This involves cloning all my repositories. I could do this manually one by one, but what is the fun in that?&lt;/p&gt;

&lt;h2&gt;Solution 1&lt;/h2&gt;

&lt;p&gt;My rule is that &amp;quot;if there is a way to make some task more efficient programatically, some one else thought of it before, so google it before starting scripting&amp;quot;. So I did, and of course someone else came up with a &lt;a href=&quot;http://haroldsoh.com/2011/10/07/clone-all-repos-from-a-bitbucket-source/&quot;&gt;solution&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Script to get all repositories under a user from bitbucket&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Usage: getAllRepos.sh [username]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## credit to Harold Soh&lt;/span&gt;
 
curl -u &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;  https://api.bitbucket.org/1.0/users/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &amp;gt; repoinfo
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; repo_name in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;grep &lt;span class=&quot;se&quot;&gt;\&amp;quot;&lt;/span&gt;name&lt;span class=&quot;se&quot;&gt;\&amp;quot;&lt;/span&gt; repoinfo &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -f4 -d&lt;span class=&quot;se&quot;&gt;\&amp;quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    hg clone ssh://hg@bitbucket.org/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$repo_name&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This however did not work perfectly for me. When downloading the rep info, the json config comes poorly formatted as a single line. This meant that the line &lt;code&gt;grep \&amp;quot;name\&amp;quot; repoinfo | cut -f4 -d\&amp;quot;&lt;/code&gt; was return &lt;code&gt;scm&lt;/code&gt;, which obviously is not what one of my repositories.&lt;/p&gt;

&lt;h2&gt;Fix&lt;/h2&gt;

&lt;p&gt;So I hacked a little and came up with a not-very-elegant-but-working-solution to parse the json:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Script to get all repositories under a user from bitbucket&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Usage: getAllRepos.sh [username]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#source: http://haroldsoh.com/2011/10/07/clone-all-repos-from-a-bitbucket-source/&lt;/span&gt;
 
curl -u &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; https://api.bitbucket.org/1.0/users/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &amp;gt; repoinfo
&lt;span class=&quot;c&quot;&gt;# curl -u adomingues https://api.bitbucket.org/1.0/users/adomingues&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# cat repoinfo&lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; repo_name in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;cat repoinfo &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sed -r &lt;span class=&quot;s1&quot;&gt;&amp;#39;s/(&amp;quot;name&amp;quot;: )/\n\1/g&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sed -r &lt;span class=&quot;s1&quot;&gt;&amp;#39;s/&amp;quot;name&amp;quot;: &amp;quot;(.*)&amp;quot;/\1/&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sed -e &lt;span class=&quot;s1&quot;&gt;&amp;#39;s/{//&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -f1 -d&lt;span class=&quot;se&quot;&gt;\&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; tr &lt;span class=&quot;s1&quot;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Cloning &amp;quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$repo_name&lt;/span&gt;
    hg clone https://&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;@bitbucket.org/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$repo_name&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;---&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This basically the same script as that of Harold, but with a more complex parsing:&lt;br&gt;
- &lt;code&gt;sed -r &amp;#39;s/(&amp;quot;name&amp;quot;: )/\n\1/g&amp;#39;&lt;/code&gt; makes sure that the repo name is not at the start of each line;&lt;br&gt;
- &lt;code&gt;sed -r &amp;#39;s/&amp;quot;name&amp;quot;: &amp;quot;(.*)&amp;quot;/\1/&amp;#39;&lt;/code&gt;, removes the string &amp;quot;name&amp;quot; at the beginning of the line;&lt;br&gt;
- &lt;code&gt;sed -e &amp;#39;s/{//&amp;#39;&lt;/code&gt; removes a funny curly bracktet ar the start of the file;&lt;br&gt;
- &lt;code&gt;cut -f1 -d\&amp;quot;&lt;/code&gt;, separates and keeps the actual repository name;&lt;br&gt;
- &lt;code&gt;tr &amp;#39;\n&amp;#39; &amp;#39; &amp;#39; &amp;#39;&lt;/code&gt; just removes the new line character creating a list of repository names to be looped.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Et voilá&lt;/em&gt;! There is probably some less convoluted away of going about it, probably involving regex, but in someone else&amp;#39;s wise words: &amp;quot;if you need regex to solve a problem, you now have 2 problems&amp;quot;.&lt;/p&gt;

&lt;p&gt;The only minor inconvenience is that I need to input my password for each repository. There might be a solution for this, but I have not found it yet.&lt;/p&gt;
</description>
        <pubDate>Sat, 10 Jan 2015 13:12:15 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/01/10/clone-all-repositories-from-a-user-bitbucket/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/01/10/clone-all-repositories-from-a-user-bitbucket/</guid>
        
        <category>bash</category>
        
        <category>bitbucket</category>
        
        <category>mercurial</category>
        
        
      </item>
    
      <item>
        <title>New shiny toy</title>
        <description>&lt;p&gt;&lt;em&gt;Updated on 11.01.2015 to correct spelling mistakes, grammar, and add new information about the speakers.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;My new laptop has arrived, and after testing it for a couple of days, I feel that I can post my own impressions of the Dell XPS13 (9333).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://media.engadget.com/img/products/454/9qbr/9qbr-800.jpg&quot; alt=&quot;Dell XPS13&quot;&gt;&lt;/p&gt;

&lt;p&gt;Those in the Linux world may have heard of it by the code name &lt;em&gt;sputnik&lt;/em&gt;. Originally this model was developed by Dell, with an eye on developers, and thus it is one of the very few laptops to be offered with Linux Ubuntu pre-installed.  As a bioinformatician, or genomics data analyst as I call myself (not very catchy), working on a *nix machine is a must. Even though I worked in OSX for a while, it never really impressed me, so when deciding on a laptop for my new job, I had three things on my wish-list:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Linux compatibility, to run all the tools I need;&lt;/li&gt;
&lt;li&gt;
light, to carry home and show results to colleagues;&lt;/li&gt;
&lt;li&gt;
somewhat powerful, to test scripts and be &amp;quot;future-proof&amp;quot;;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Some specs&lt;/h2&gt;

&lt;p&gt;With the above in mind, I got the XP13 with the following specs:&lt;/p&gt;

&lt;p&gt;Intel(r) Core(tm) i7-4510U  (4M Cache, up to 3.1 GHz)&lt;br&gt;
8 GB Dual-Channel DDR3 with 1.600 MHz&lt;br&gt;
Solid-State-hardrive (SSD) with 512 GB&lt;br&gt;
Intel HD Grafics 4400&lt;br&gt;
1.37 kg&lt;/p&gt;

&lt;p&gt;Unfortunately the model with pre-installed Ubuntu was not available in Germany, apparently they are out of stock, so mine came with Windows 8 pre-installed. Obviously the 1st thing I did to replace Windows with a fresh install of Ubuntu 14.04 from a liveUSB. Everything pretty much worked out of the box, which is the new unremarkable normal for modern Linux distros, specially those based on Ubuntu. Of note, the touchscreen  (which I do not care about) works, at least selecting and scrolling. Connecting the wifi was also a doodle. It took me almost more time to disable the annoying Windows features to allow the Linux installation than it did to make the install itself. In less than 1 hour I had the computer ready to work.&lt;/p&gt;

&lt;h2&gt;Review&lt;/h2&gt;

&lt;h3&gt;Design&lt;/h3&gt;

&lt;p&gt;Oh boy does it look good! Nice aluminium touch, very elegant. I could compare it to a Macbook Air and it is noticeable smaller, both in width and depth, and prettier for my eyes.&lt;/p&gt;

&lt;h3&gt;Screen&lt;/h3&gt;

&lt;p&gt;Excellent resolution, bright colours - amazing.  The less fun part is that at 1920x1080 fonts and icons are rather small, but nothing that can&amp;#39;t be fixed.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;coil whine&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This refers to a wizz sound coming from the keyboard area. In my case it is barely noticeable, and turning of the keyboard back-lighting stops it. I don&amp;#39;t care about this light so it works for me. Most of the time the noise is barely audible though.&lt;/p&gt;

&lt;h3&gt;Temperature&lt;/h3&gt;

&lt;p&gt;This is something of a problem with Linux laptops. I have installed laptop-mode-tools and, as we speak, it is running at 45-55ºc, with Firefox, Thunderbird, Sublime text, and terminal open. So not an issue for me.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Keyboard and mousepad&lt;/strong&gt;&lt;br&gt;
The keyboard is responsive, without being too edgy. The mouse pad is rather large, and does not have physically separated buttons, so it I am still adjusting and trying to the right-click. Both feel somewhat roughed, at least in comparison to my Toshiba T230, which is neither a good or bad thing, it just offers more resistance and feedback to the touch. It should be noted that the page-up and -down do not have dedicated buttons, nor does the end/start (so useful to navigate lines of code). However, the use of &lt;code&gt;fn + arrows&lt;/code&gt; solves the problem.&lt;/p&gt;

&lt;h3&gt;Sound&lt;/h3&gt;

&lt;p&gt;Good enough. This is a laptop, not a sound system. Scracth that, after some more testing, the sound is loud and clear. Very decent (for a laptop of course).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;battery life&lt;/strong&gt;&lt;br&gt;
It looks like I can squeeze 5 hours out of it easily, but it is too early to tell.&lt;/p&gt;

&lt;h3&gt;Dock&lt;/h3&gt;

&lt;p&gt;I also got a Dell dock with it, because let&amp;#39;s face it, 2 USB entries is just low, and I am connected to a server most of the time and prefer to do it over an ethernet connection for stability. From what I tested so far, the sound and display entries of the dock do not work. On the other hand, the USB and the ethernet work.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;All in all I am very happy with my new shinny Ubuntu ultrabook. And I stress ultra because coming from a 4 year old laptop (still working well) with less than 2 kg, I cannot entertain the thought of not having a light laptop and the XPS13 is the perfect upgrade to my Toshiba T230.&lt;/p&gt;
</description>
        <pubDate>Thu, 08 Jan 2015 19:12:38 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/01/08/new-shiny-toy/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/01/08/new-shiny-toy/</guid>
        
        <category>hardware</category>
        
        <category>linux</category>
        
        
      </item>
    
      <item>
        <title>The &quot;p&quot; problem in R plots, or when a dot is a font in inkscape</title>
        <description>&lt;p&gt;My graphics/figure workflow generally involves plotting something in R, saving it as a pdf (+png if writing a report with &lt;em&gt;Rmarkdown&lt;/em&gt;), followed by some manual editing with &lt;a href=&quot;https://inkscape.org/&quot;&gt;Inkscape&lt;/a&gt;. Inkscape is a free, as in speech &lt;strong&gt;and&lt;/strong&gt; beer, vector graphics editor - think of a non-commercial Illustrator - and it has very very useful since most of the time I don&amp;#39;t have access to Illustrator, through a combination of working mostly in Linux and the groups not paying for a license. No matter as Inkscape serves me well, including for personal use.&lt;/p&gt;

&lt;h2&gt;Problem&lt;/h2&gt;

&lt;p&gt;Back to the science. There is a quick with R plots: by default plots save symbols as fonts &lt;a href=&quot;http://en.wikipedia.org/wiki/Dingbat&quot;&gt;dingbats font&lt;/a&gt;. This means that when opening a pdf created with R in Inkscape (or Illustrator), points are (correctly) displayed as &amp;quot;p&amp;quot;. Even though this is technically correct, it is a nightmare when editing a figure last minute before a presentation.&lt;/p&gt;

&lt;h2&gt;Solution&lt;/h2&gt;

&lt;p&gt;Set set the option &lt;code&gt;r useDingbats = FALSE&lt;/code&gt; when saving the plot:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dat &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
pdf&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;plot.pdf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; useDingbats &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
dev.off&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Or even better, make use of Rprofile for more than &lt;a href=&quot;http://movingtothedarkside.wordpress.com/2015/01/05/nerd-up-your-r/&quot;&gt;witty R quotes&lt;/a&gt;, adding to it the line &lt;code&gt;grDevices::pdf.optionspdf.options(useDingbats = FALSE)&lt;/code&gt;. Like this, you will not have to remember this every time a plot is saved. And if you are like me, this will happen often - both the saving and the forgetting.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.inkscapeforum.com/viewtopic.php?f=5&amp;amp;t=7581&quot;&gt;Source1&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://support.rstudio.com/hc/communities/public/questions/200664843-Problem-reading-exported-PDFs-in-other-programs&quot;&gt;Source2&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 06 Jan 2015 10:55:25 +0100</pubDate>
        <link>http://0.0.0.0:4000/2015/01/06/the-p-problem-in-r-plots-or-when-a-dot-is-a-font-in-inkscape/</link>
        <guid isPermaLink="true">http://0.0.0.0:4000/2015/01/06/the-p-problem-in-r-plots-or-when-a-dot-is-a-font-in-inkscape/</guid>
        
        <category>Inkscape</category>
        
        <category>plots</category>
        
        <category>R</category>
        
        
      </item>
    
  </channel>
</rss>
